<% include ./partials/header.ejs %>
  <div class="w-full min-h-screen bg-zinc-900 text-white py-5">
    <!-- insta logo  -->
    <div class="w-full px-4 flex items-center justify-between">
      <img class="w-1/4" src="/images/logo.png" alt="">
      <div class="icons -mt-2 flex gap-5 items-center">
        <i class="text-[1.4rem] ri-heart-3-line"></i>
        <i class="text-[1.4rem] ri-messenger-line"></i>
      </div>
    </div>
    <!-- STORY AND ALL -->
    <div class="story px-3 flex gap-3 overflow-auto mt-5">
      <div class="circle flex-shrink-0">
        <div
          class="gradient w-[18vw] h-[18vw] bg-sky-100 rounded-full bg-gradient-to-r from-purple-700 to-orange-500 flex items-center justify-center">
          <div class="inner w-[92%] h-[92%] rounded-full overflow-hidden">
            <img class="w-full h-full object-cover"
              src="https://images.unsplash.com/photo-1531746020798-e6953c6e8e04?q=80&w=2550&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
              alt="">
          </div>
        </div>
      </div>
      <div class="circle flex-shrink-0">
        <div
          class="gradient w-[18vw] h-[18vw] bg-sky-100 rounded-full bg-gradient-to-r from-purple-700 to-orange-500 flex items-center justify-center">
          <div class="inner w-[92%] h-[92%] rounded-full overflow-hidden">
            <img class="w-full h-full object-cover"
              src="https://images.unsplash.com/photo-1570158268183-d296b2892211?q=80&w=3456&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
              alt="">
          </div>
        </div>
      </div>
      <div class="circle flex-shrink-0">
        <div
          class="gradient w-[18vw] h-[18vw] bg-sky-100 rounded-full bg-gradient-to-r from-purple-700 to-orange-500 flex items-center justify-center">
          <div class="inner w-[92%] h-[92%] rounded-full overflow-hidden">
            <img class="w-full h-full object-cover"
              src="https://images.unsplash.com/photo-1531746020798-e6953c6e8e04?q=80&w=2550&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
              alt="">
          </div>
        </div>
      </div>
      <div class="circle flex-shrink-0">
        <div
          class="gradient w-[18vw] h-[18vw] bg-sky-100 rounded-full bg-gradient-to-r from-purple-700 to-orange-500 flex items-center justify-center">
          <div class="inner w-[92%] h-[92%] rounded-full overflow-hidden">
            <img class="w-full h-full object-cover"
              src="https://images.unsplash.com/photo-1570158268183-d296b2892211?q=80&w=3456&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
              alt="">
          </div>
        </div>
      </div>
      <div class="circle flex-shrink-0">
        <div
          class="gradient w-[18vw] h-[18vw] bg-sky-100 rounded-full bg-gradient-to-r from-purple-700 to-orange-500 flex items-center justify-center">
          <div class="inner w-[92%] h-[92%] rounded-full overflow-hidden">
            <img class="w-full h-full object-cover"
              src="https://images.unsplash.com/photo-1531746020798-e6953c6e8e04?q=80&w=2550&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
              alt="">
          </div>
        </div>
      </div>
      <div class="circle flex-shrink-0">
        <div
          class="gradient w-[18vw] h-[18vw] bg-sky-100 rounded-full bg-gradient-to-r from-purple-700 to-orange-500 flex items-center justify-center">
          <div class="inner w-[92%] h-[92%] rounded-full overflow-hidden">
            <img class="w-full h-full object-cover"
              src="https://images.unsplash.com/photo-1570158268183-d296b2892211?q=80&w=3456&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
              alt="">
          </div>
        </div>
      </div>
    </div>
    <div class="posts mb-20">
      <% posts.reverse().forEach(element => {
        %>
        <div class="post mt-10 w-full min-h-[50vh]">
        <div class="title px-4 flex items-center gap-2 justify-between">
          <div class="flex px-1 items-center gap-3">
              <div class="w-[8vw] h-[8vw] bg-sky-100 rounded-full overflow-hidden">
                <img src="/images/uploads/<%= element.user.profilepicture%>" class="object-fit w-full h-full" alt="">  
              </div>
            <h4 class="text-sm"><%= element.user.username%></h4>
            </div>
            <div class="flex px-1 items-center gap-3">
              <h6 class="text-xs opacity-30">1d</h6>
              <% if(user.posts.indexOf(element._id) != -1){%>
                
                <a href="/post/delete/<%= element._id%>"><i class="ri-delete-bin-5-line"></i></a>
              <%} %>
            </div>

        </div>
            <a href="/post/click/<%= element._id%>">
        <div class="w-full h-96 mt-4 bg-sky-100 overflow-hidden">
          <img src="/images/uploads/<%= element.post%>" class="object-cover w-full h-full" alt="">
        </div></a>
        <div class="options w-full px-4 flex justify-between items-center text-[1.4rem]">
          <div class="flex gap-3 mt-2">
            <% if(element.likes.indexOf(user._id) == -1){%>
              <a href="/like/post/<%= element._id %>"><i class="ri-heart-3-line"></i></a>
            <%}else{%>
              <a href="/like/post/<%= element._id %>"><i class="ri-heart-3-fill text-red-600"></i></a>
            <%
            }
            %>
            <a href="/post/click/<%= element._id%>">
              <i class="ri-chat-3-line"></i>
            </a>
            <i class="ri-share-circle-line"></i>
          </div>
          <i class="ri-bookmark-line"></i>
        </div>
        <h3 class="px-4 mt-2 text-sm leading-none tracking-tight"><%= element.likes.length%> likes</h3>
        <h2 class="text-white font-light text-sm mt-2"><span class="font-semibold pl-4 pr-2"><%= element.user.username%></span><%= element.caption%></h2>
      </div>
        <%
      }); %>
    </div>
  </div>


  <script>
        
        // Save scroll position before refreshing the page
    window.onbeforeunload = function() {
      sessionStorage.setItem('scrollPosition', window.scrollY.toString());
    };

    // Restore scroll position after the page is loaded
    window.onload = function() {
      const scrollPosition = sessionStorage.getItem('scrollPosition');
      if (scrollPosition) {
        window.scrollTo(0, parseInt(scrollPosition, 10));
        sessionStorage.removeItem('scrollPosition'); // Optional: Clear the stored position
      }
    };

  </script>
  <% include ./partials/footer.ejs %>